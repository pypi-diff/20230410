# Comparing `tmp/dcontainer-1.0.6-py3-none-any.whl.zip` & `tmp/dcontainer-1.0.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,31 +1,31 @@
-Zip file size: 17129 bytes, number of entries: 29
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/__init__.py
--rw-r--r--  2.0 unx      662 b- defN 23-Apr-06 13:36 dcontainer/__main__.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/py.typed
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/cli/__init__.py
--rw-r--r--  2.0 unx      685 b- defN 23-Apr-06 13:36 dcontainer/cli/generate.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/__init__.py
--rw-r--r--  2.0 unx     1056 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/oci_feature_generator.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/dir_models/__init__.py
--rw-r--r--  2.0 unx     1608 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/dir_models/src_dir.py
--rw-r--r--  2.0 unx      982 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/dir_models/test_dir.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/__init__.py
--rw-r--r--  2.0 unx      388 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/devcontainer_feature_json.py
--rw-r--r--  2.0 unx     3608 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/install_sh.py
--rw-r--r--  2.0 unx     5999 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/library_scripts_sh.py
--rw-r--r--  2.0 unx     2403 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/readme_md.py
--rw-r--r--  2.0 unx      577 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/scenarios_json.py
--rw-r--r--  2.0 unx      460 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/feature_generation/file_models/test_sh.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/models/__init__.py
--rw-r--r--  2.0 unx     6366 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/models/devcontainer_feature.py
--rw-r--r--  2.0 unx     1534 b- defN 23-Apr-06 13:36 dcontainer/devcontainer/models/devcontainer_feature_definition.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-06 13:36 dcontainer/utils/__init__.py
--rw-r--r--  2.0 unx      627 b- defN 23-Apr-06 13:36 dcontainer/utils/settings.py
--rw-r--r--  2.0 unx     1387 b- defN 23-Apr-06 13:36 dcontainer/utils/version.py
--rw-r--r--  2.0 unx     3452 b- defN 23-Apr-06 13:37 dcontainer-1.0.6.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-06 13:37 dcontainer-1.0.6.dist-info/WHEEL
--rw-r--r--  2.0 unx       56 b- defN 23-Apr-06 13:37 dcontainer-1.0.6.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       11 b- defN 23-Apr-06 13:37 dcontainer-1.0.6.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2948 b- defN 23-Apr-06 13:37 dcontainer-1.0.6.dist-info/RECORD
-29 files, 34901 bytes uncompressed, 12125 bytes compressed:  65.3%
+Zip file size: 17253 bytes, number of entries: 29
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/__init__.py
+-rw-r--r--  2.0 unx      662 b- defN 23-Apr-10 18:18 dcontainer/__main__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/py.typed
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/cli/__init__.py
+-rw-r--r--  2.0 unx      685 b- defN 23-Apr-10 18:18 dcontainer/cli/generate.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/__init__.py
+-rw-r--r--  2.0 unx     1056 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/oci_feature_generator.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/dir_models/__init__.py
+-rw-r--r--  2.0 unx     1599 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/dir_models/src_dir.py
+-rw-r--r--  2.0 unx      982 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/dir_models/test_dir.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/__init__.py
+-rw-r--r--  2.0 unx      388 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/devcontainer_feature_json.py
+-rw-r--r--  2.0 unx     4122 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/install_sh.py
+-rw-r--r--  2.0 unx     6168 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/library_scripts_sh.py
+-rw-r--r--  2.0 unx     2403 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/readme_md.py
+-rw-r--r--  2.0 unx      577 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/scenarios_json.py
+-rw-r--r--  2.0 unx      460 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/feature_generation/file_models/test_sh.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/models/__init__.py
+-rw-r--r--  2.0 unx     6366 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/models/devcontainer_feature.py
+-rw-r--r--  2.0 unx     1534 b- defN 23-Apr-10 18:18 dcontainer/devcontainer/models/devcontainer_feature_definition.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-10 18:18 dcontainer/utils/__init__.py
+-rw-r--r--  2.0 unx      627 b- defN 23-Apr-10 18:18 dcontainer/utils/settings.py
+-rw-r--r--  2.0 unx     1387 b- defN 23-Apr-10 18:18 dcontainer/utils/version.py
+-rw-r--r--  2.0 unx     3452 b- defN 23-Apr-10 18:18 dcontainer-1.0.7.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-10 18:18 dcontainer-1.0.7.dist-info/WHEEL
+-rw-r--r--  2.0 unx       56 b- defN 23-Apr-10 18:18 dcontainer-1.0.7.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       11 b- defN 23-Apr-10 18:18 dcontainer-1.0.7.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2948 b- defN 23-Apr-10 18:18 dcontainer-1.0.7.dist-info/RECORD
+29 files, 35575 bytes uncompressed, 12249 bytes compressed:  65.6%
```

## zipnote {}

```diff
@@ -66,23 +66,23 @@
 
 Filename: dcontainer/utils/settings.py
 Comment: 
 
 Filename: dcontainer/utils/version.py
 Comment: 
 
-Filename: dcontainer-1.0.6.dist-info/METADATA
+Filename: dcontainer-1.0.7.dist-info/METADATA
 Comment: 
 
-Filename: dcontainer-1.0.6.dist-info/WHEEL
+Filename: dcontainer-1.0.7.dist-info/WHEEL
 Comment: 
 
-Filename: dcontainer-1.0.6.dist-info/entry_points.txt
+Filename: dcontainer-1.0.7.dist-info/entry_points.txt
 Comment: 
 
-Filename: dcontainer-1.0.6.dist-info/top_level.txt
+Filename: dcontainer-1.0.7.dist-info/top_level.txt
 Comment: 
 
-Filename: dcontainer-1.0.6.dist-info/RECORD
+Filename: dcontainer-1.0.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## dcontainer/devcontainer/feature_generation/dir_models/src_dir.py

```diff
@@ -26,22 +26,21 @@
         definition_model: FeatureDefinition,
         nanolayer_version: Optional[str] = None,
     ) -> "Directory":
         feature_id = definition_model.id
 
         virtual_dir = {}
 
-        virtual_dir[f"{feature_id}/library_scripts.sh"] = LibraryScriptsSH(
-            nanolayer_version=nanolayer_version,
-        )
+        virtual_dir[f"{feature_id}/library_scripts.sh"] = LibraryScriptsSH()
 
         virtual_dir[f"{feature_id}/install.sh"] = InstallSH(
             install_command=definition_model.install_command,
             options=definition_model.options,
             dependencies=definition_model.dependencies,
+            nanolayer_version=nanolayer_version,
         )
         virtual_dir[f"{feature_id}/README.md"] = ReadmeMD(
             definition_model=definition_model,
             oci_registry="ghcr.io",
             namespace="devcontainers-contrib/features",
         )
         virtual_dir[
```

## dcontainer/devcontainer/feature_generation/file_models/install_sh.py

```diff
@@ -3,14 +3,15 @@
 
 from easyfs import File
 
 from dcontainer.devcontainer.models.devcontainer_feature import FeatureOption
 from dcontainer.devcontainer.models.devcontainer_feature_definition import (
     FeatureDependencies,
 )
+from dcontainer.utils.version import resolve_nanolayer_release_version
 
 logger = logging.getLogger(__name__)
 
 
 SINGLE_DEPENDENCY = """$nanolayer_location \\
     install \\
     devcontainer-feature \\
@@ -25,15 +26,15 @@
 source ./library_scripts.sh
 
 # nanolayer is a cli utility which keeps container layers as small as possible
 # source code: https://github.com/devcontainers-contrib/nanolayer
 # `ensure_nanolayer` is a bash function that will find any existing nanolayer installations, 
 # and if missing - will download a temporary copy that automatically get deleted at the end 
 # of the script
-ensure_nanolayer nanolayer_location
+ensure_nanolayer nanolayer_location {nanolayer_version}
 
 
 {dependency_installation_lines}
 
 {install_command}
 
 """
@@ -43,18 +44,26 @@
     REF_PREFIX = "$options."
 
     def __init__(
         self,
         install_command: str,
         dependencies: Optional[FeatureDependencies],
         options: Optional[Dict[str, FeatureOption]],
+        nanolayer_version: Optional[str] = None,
     ) -> None:
         self.install_command = install_command
         self.dependencies = dependencies or []
         self.options = options
+        try:
+            self.nanolayer_version = nanolayer_version or resolve_nanolayer_release_version()
+        except Exception as e:
+            raise ValueError(
+                "could not resolve nanolayer version because of error, please manually set nanolayer_version release_verison"
+            ) from e
+    
         super().__init__(content=self.to_str().encode())
 
     def to_str(self) -> str:
         installation_lines = []
         for feature_dependency in self.dependencies:
             resolved_params = {}
             for param_name, param_value in feature_dependency.options.items():
@@ -68,14 +77,15 @@
             installation_lines.append(
                 self.create_install_command(feature_dependency.feature, resolved_params)
             )
         dependency_installation_lines = "\n\n".join(installation_lines)
         return HEADER.format(
             dependency_installation_lines=dependency_installation_lines,
             install_command=self.install_command,
+            nanolayer_version=self.nanolayer_version,
         )
 
     @staticmethod
     def _escape_qoutes(value: str) -> str:
         return value.replace('"', '\\"')
 
     @classmethod
```

## dcontainer/devcontainer/feature_generation/file_models/library_scripts_sh.py

```diff
@@ -1,15 +1,13 @@
 from typing import Optional
 
 from easyfs import File
 
 from dcontainer.utils.settings import ENV_CLI_LOCATION, ENV_FORCE_CLI_INSTALLATION
-from dcontainer.utils.version import resolve_nanolayer_release_version
 
-RELEASE_LINK = """{RELEASE_VERSION}"""
 
 HEADER = """#!/bin/bash -i
 
 
 clean_download() {{
     # The purpose of this function is to download a file with minimal impact on contaier layer size
     # this means if no valid downloader is found (curl or wget) then we install a downloader (currently wget) in a 
@@ -103,27 +101,49 @@
 
 }}
 
 
 ensure_nanolayer() {{
     # Ensure existance of the nanolayer cli program
     local variable_name=$1
+
+    local required_version=$2
+    # normalize version
+    if ! [[ $required_version == v* ]]; then
+        required_version=v$required_version
+    fi
+
     local nanolayer_location=""
 
     # If possible - try to use an already installed nanolayer
     if [[ -z "${{{force_cli_installation_env}}}" ]]; then
         if [[ -z "${{{cli_location_env}}}" ]]; then
             if type nanolayer >/dev/null 2>&1; then
-                echo "Using a pre-existing nanolayer"
+                echo "Found a pre-existing nanolayer in PATH"
                 nanolayer_location=nanolayer
             fi
         elif [ -f "${{{cli_location_env}}}" ] && [ -x "${{{cli_location_env}}}" ] ; then
-            echo "Using a pre-existing nanolayer which were given in env varialbe"
             nanolayer_location=${{{cli_location_env}}}
+            echo "Found a pre-existing nanolayer which were given in env varialbe: $nanolayer_location"
+        fi
+
+        # make sure its of the required version
+        if ! [[ -z "${{nanolayer_location}}" ]]; then
+            local current_version
+            current_version=$($nanolayer_location --version)
+            if ! [[ $current_version == v* ]]; then
+                current_version=v$current_version
+            fi
+
+            if ! [ $current_version == $required_version ]; then
+                echo "skipping usage of pre-existing nanolayer. (required version $required_version does not match existing version $current_version)"
+                nanolayer_location=""
+            fi
         fi
+
     fi
 
     # If not previuse installation found, download it temporarly and delete at the end of the script 
     if [[ -z "${{nanolayer_location}}" ]]; then
 
         if [ "$(uname -sm)" == "Linux x86_64" ] || [ "$(uname -sm)" == "Linux aarch64" ]; then
             tmp_dir=$(mktemp -d -t nanolayer-XXXXXXXXXX)
@@ -141,15 +161,15 @@
             else
                 clib_type=gnu
             fi
 
             tar_filename=nanolayer-"$(uname -m)"-unknown-linux-$clib_type.tgz
 
             # clean download will minimize leftover in case a downloaderlike wget or curl need to be installed
-            clean_download https://github.com/devcontainers-contrib/cli/releases/download/{nanolayer_version}/$tar_filename $tmp_dir/$tar_filename
+            clean_download https://github.com/devcontainers-contrib/cli/releases/download/$required_version/$tar_filename $tmp_dir/$tar_filename
             
             tar xfzv $tmp_dir/$tar_filename -C "$tmp_dir"
             chmod a+x $tmp_dir/nanolayer
             nanolayer_location=$tmp_dir/nanolayer
       
 
         else
@@ -166,27 +186,15 @@
 
 """
 
 
 class LibraryScriptsSH(File):
     def __init__(
         self,
-        nanolayer_version: Optional[str] = None,
     ) -> None:
-        self.nanolayer_version = nanolayer_version
         super().__init__(self.to_str().encode())
 
     def to_str(self):
-        try:
-            nanolayer_version = (
-                self.nanolayer_version or resolve_nanolayer_release_version()
-            )
-        except Exception as e:
-            raise ValueError(
-                "could not resolve nanolayer version because of error, please manually set nanolayer_version release_verison"
-            ) from e
-
         return HEADER.format(
-            nanolayer_version=nanolayer_version,
             force_cli_installation_env=ENV_FORCE_CLI_INSTALLATION,
             cli_location_env=ENV_CLI_LOCATION,
         )
```

## Comparing `dcontainer-1.0.6.dist-info/METADATA` & `dcontainer-1.0.7.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 Metadata-Version: 2.1
 Name: dcontainer
-Version: 1.0.6
+Version: 1.0.7
 Author: Daniel Braun
 Description-Content-Type: text/markdown
-Requires-Dist: pydantic (==1.10.5)
+Requires-Dist: pydantic (==1.10.7)
 Requires-Dist: typer
 Requires-Dist: semver (==2.13.0)
 Requires-Dist: easyfs (==0.0.3)
 Provides-Extra: dev
 Requires-Dist: pytest ; extra == 'dev'
 Requires-Dist: pytest-shell-utilities ; extra == 'dev'
 Requires-Dist: black ; extra == 'dev'
```

## Comparing `dcontainer-1.0.6.dist-info/RECORD` & `dcontainer-1.0.7.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -3,27 +3,27 @@
 dcontainer/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/cli/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/cli/generate.py,sha256=Bwz3XRF3PP_3hRKuT4IAIyMdwWVYCr9Fw0elCpSkSgQ,685
 dcontainer/devcontainer/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/devcontainer/feature_generation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/devcontainer/feature_generation/oci_feature_generator.py,sha256=hQKfYBi5wJafHVu9eEsFR69VGiVeQ0MH3Fcnq7vmxIM,1056
 dcontainer/devcontainer/feature_generation/dir_models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-dcontainer/devcontainer/feature_generation/dir_models/src_dir.py,sha256=TrlzahoQujgDHM0rv7Hwv1yqkNcajvnnfTPjm13dhro,1608
+dcontainer/devcontainer/feature_generation/dir_models/src_dir.py,sha256=M4bH-3ZbRlaUz22AufNx7afrXOhxK7HlKrXTP_rHhQg,1599
 dcontainer/devcontainer/feature_generation/dir_models/test_dir.py,sha256=UgRbYE1A2RZo_zKp5e1_5q2OAE3SaZWiaEO1Ir3bhq0,982
 dcontainer/devcontainer/feature_generation/file_models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/devcontainer/feature_generation/file_models/devcontainer_feature_json.py,sha256=w1BdoHyUQzf6COFVhcxBzvo3ixAE3ck5ObUynjf5rrA,388
-dcontainer/devcontainer/feature_generation/file_models/install_sh.py,sha256=C-EEA0oycCt8LMMWLkL9H_gF7AKqPH4ghphZJEv1bMM,3608
-dcontainer/devcontainer/feature_generation/file_models/library_scripts_sh.py,sha256=nC5kvMLr1wa9w11pb5jw3hZZlUqNvhFDlehcntyNRpg,5999
+dcontainer/devcontainer/feature_generation/file_models/install_sh.py,sha256=6Q2wEXK9RPsoGxgMRDWv1Nz2UPAtNGoAhiNMh1Ts5jY,4122
+dcontainer/devcontainer/feature_generation/file_models/library_scripts_sh.py,sha256=3ukUvKfZrMfutXIPKA4y91KE4AfsN_pSNgi3iYEa4mc,6168
 dcontainer/devcontainer/feature_generation/file_models/readme_md.py,sha256=fO66l24bjtmx1LHutECirCINoR_vM7STGIfsI2UmkGY,2403
 dcontainer/devcontainer/feature_generation/file_models/scenarios_json.py,sha256=KeDAEfoYmeo6CK1BIfETSY2WLgVC8jIop6WQewFT2qM,577
 dcontainer/devcontainer/feature_generation/file_models/test_sh.py,sha256=y1UrBYQa3EHx-ZB2CU4vmlpQC_xHlxE0KrOvdLoYGX8,460
 dcontainer/devcontainer/models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/devcontainer/models/devcontainer_feature.py,sha256=25mWY6oU1GbWv74xlryPoHbOsGjvAPvZ483dcxVOqWY,6366
 dcontainer/devcontainer/models/devcontainer_feature_definition.py,sha256=Z6RAI5wyiZb-9pvhQstJ3R-ZmpA7krf1xFoNN_EWOYk,1534
 dcontainer/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 dcontainer/utils/settings.py,sha256=IxcxEblbyNxWLrj5JG78iatZkgqWhK8SwNhJkQ1scIM,627
 dcontainer/utils/version.py,sha256=oo6yROUdXk-JlGtoccHORQlxEUEiOM3UxXjzNwiJJPE,1387
-dcontainer-1.0.6.dist-info/METADATA,sha256=Ota2-jRHTBtn76DfqCbGhLIEoNkgvba-LA_xHBI5PzQ,3452
-dcontainer-1.0.6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-dcontainer-1.0.6.dist-info/entry_points.txt,sha256=Ir9OUF6kqae1fYrXQGg31EwpvqV3QmD_4FMfgMsYRoY,56
-dcontainer-1.0.6.dist-info/top_level.txt,sha256=_gvPjGYhxRs0y_Cw3IO-Kv0fjKgreD_rmmHCKXR_rm4,11
-dcontainer-1.0.6.dist-info/RECORD,,
+dcontainer-1.0.7.dist-info/METADATA,sha256=OBdy7s0JXeURplL3fLF5htDEBpeRk4kh0tj4nB3ly98,3452
+dcontainer-1.0.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+dcontainer-1.0.7.dist-info/entry_points.txt,sha256=Ir9OUF6kqae1fYrXQGg31EwpvqV3QmD_4FMfgMsYRoY,56
+dcontainer-1.0.7.dist-info/top_level.txt,sha256=_gvPjGYhxRs0y_Cw3IO-Kv0fjKgreD_rmmHCKXR_rm4,11
+dcontainer-1.0.7.dist-info/RECORD,,
```

